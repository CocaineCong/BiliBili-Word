# 搜索引擎原理

当遇到问题的时候，我们经常会在百度查找想要的答案，那百度是怎么通过我们的关键词判断我们的意图并展示出相关答案给我们的呢？这个视频我们就来讲一下搜索引擎的原理。



## 1. What？什么是搜索引擎

首先，我们先了解一下，什么是搜索引擎？

搜索引擎就是一种在线搜索工具，当用户在搜索框输入关键词时，搜索引擎就会将对应的内容展示给用户。

现在比较大型的搜索引擎有谷歌，雅虎，必应还有我们的百度。当然，像我们嵌入在app里面的搜索，也是搜索引擎。只不是上面的搜索引擎是“搜全网”，把全网的网站放到自己的数据库中，app里面的搜索一般只是站内的搜索。

 

> 比如：在b站搜索一些视频，搜索出来的结果
>
> 比如：在某东搜索一个商品，搜索出来的这个排名就会嵌入一些广告，这些广告就是品牌方给平台一些钱之类的好处，让平台提升他们的搜索排名。

ok, 大致了解了搜索引擎之后，我们再来讲一下搜索引擎的原理



## 2. How ？搜索引擎的原理

> 搜索引擎原理是指搜索引擎如何搜索和索引网页上的信息，以及搜索结果如何排序的过程。

相对成熟的搜索引擎工作原理可以分为三个步骤：  

1. 爬虫（Crawler）：爬虫是一种自动化程序，它可以搜索网页并将 找到的网页 保存到搜索引擎的服务器上，以便进行索引。
2. 索引（Indexing）：索引是搜索引擎给每个网页分配一个关键字，以便搜索引擎能够快速地找到对应的网页。
3. 排名（Ranking）：排序是搜索引擎根据搜索关键字对搜索结果进行打分排序，根据相关性的高低进行排名，以便用户能够找到最相关的网页。当然，一些搜索引擎偶尔也会在排名中穿插广告。

 

那么我们一点点来讲讲搜索引擎的这三个步骤。 

### 2.1 爬虫

搜索引擎会 派出一个抓取网页文件的代码程序用来发现新网页，通常被称为爬虫。

这是一种自动抓取网络信息的程序，它通过模拟人类访问网站的行为，自动访问网站，抓取网站上的信息，然后将抓取到的信息保存到数据库中。

首先，它会从一个或多个指定的网址开始，然后根据程序设定的规则，从网页中抓取所需要的信息，并将抓取的信息保存到本地或者服务器上。抓取的过程中，爬虫会不断地从网页中提取出新的网址，然后继续抓取，这一过程会一直持续下去，直到爬虫抓取到所有符合要求的信息为止。

现在一个新网站一般半个月就会被搜索引擎所收录。

如果我们不希望我们的网页被爬虫访问收录的话，我们可以在 robot.txt 文件中指定。 

一般来说搜索引擎分配给每个网站的爬行预算是固定的，这里的预算包括爬取时间，爬取文字长 度，爬取操作，如果我们将预算浪费在不重要的页面，那么相对应的，我们那些重要的页面，被收录的概率就会变低。比如这个就是 B站 的 robots.txt。

![image-20230116195737144](https://raw.githubusercontent.com/CremeU/cloud-img/main/image-20230116195737144.png)



我们可以看到，b站的robots.txt 和其他网站的robots.txt 都是类似的，都希望自己的页面被各个搜索引擎的爬虫收录。

一般的网站都希望被搜索引擎的爬虫访问，这样网站的流量入口就多了一个。然后就涉及到了SEO，全称就是Search Engine Optimization。搜索引擎优化：让网站更易于搜索引擎处理的过程；提升 网站在网络上的曝光度。这个SEO也有大讲究，之后有时间我们可以讲讲。



如果看到这里，你还疑惑，欸？搜索引擎不是全网搜索吗？难道有些网站，还会出现，在百度能搜出来，在其他搜索引擎就搜不出来的情况？ 

听我解释一下，其实我们所谓的搜索引擎全网搜，这个全网是一个伪全网，举个例子，我们进入百度的搜索引擎页面，其实我们进入了是百度这个网站，只是这个网站的爬虫收录了很多其他的网站，让你以为你是在全网。在这个例子上再举一个例子，如果我是新上线了一个网站，就叫 “FanOne商城” ，我不想让 我的网页被百度收录，那我就可以在 robots.txt 设置不让百度的爬虫爬去收录。这样当你百度 FanOne商城的时候，在百度的网站上就没有任何fanone商城的信息了，只能乖乖的输入fanone商城的域名，在去到我的网站上面操作了。



### 2.2 索引

我们了解完第一步爬虫之后，我们来讲讲索引。2022年全球的域名数量已经达到了 3.115亿， 每个网站又有数不胜数的子页面，网页内容等等。再加上这个信息爆炸的时代，搜索引擎的数据库中已经收录了数以万亿级的网站信息，这时候，为了快速找到对应的网址，我们就要对这些网站信息建立索引。

索引就是 有一个key 会对应一个 value。一般分成正排索引和倒排索引。 

正排索引就是将关键字映射到文档ID的一种有序映射表，用于快速查找文档。

例如：

1. 查字典的时候，查找拼音或者偏旁就能快速找到这个某个字 
2. 以地址为键，查找对应的位置信息



而搜索引擎一般是建立倒排索引，倒排索引是它将文本中的每个单词映射到它出现的文档列表中，可以快速查找特定的文档，其中包含特定的单词。

例如有一组网页： 

网页1：山西苹果是一种水果 ---> 提取关键字 山西、苹果、水果  

网页2：橘子是一种水果 ---> 提取关键字 橘子、水果 

网页3：广西苹果是一种苹果 ---> 提取关键字 广西、苹果

倒排索引表如下：  

苹果：文档1，文档3 

水果：文档1，文档2 

橘子：文档2 

这就是一种 文档与关键词的相关性，

当我们搜索苹果的时候就会出现第一种情况，搜索水果的时候，就会出现第二种情况。

当然，我们发现苹果有两种种类，一种是山西，一种是广西，山西苹果在网页1，广西苹果在网页2

那怎么判定返回的结果是 山西苹果 在前面 还是 广西苹果 在前面呢？

> 也就是说 当我们搜索苹果的时候，是出现网页1，网页3 这种顺序还是，网页3，网页1 这种顺序 

这就涉及到了搜索引擎最后一个步骤，结果的计算排名。

### 2.3 排名

我们从上面就知道了，搜索引擎会调用``索引库数据``，计算文档与关键词的相关性，搜索出多条文档结果。

我们最终还好对这些文档结果进行排名，经过多年的发展，谷歌的页面排名规则已经超过了200多条，但是没有人知道具体规则是什么。而百度的排名规则就比较明显了

常见的排名因素 

1. 内容相关性：页面标题与用户查询关键词的相关性，相关性越高的页面，排名就越靠前，也越能满足用户需求，用户不需要再点开，就已经知道答案了
2.  内容质量：现在越来越提倡高质量内容输出了，也就是说哪怕你的内容相关性很高，但是其质量低下，也很难获得很好的排名。比如页面充斥了关键词堆砌、来源模糊的信息，重复度很高等。
3. 链接权重：链接主要有站内链接和站外链接两种，某种角度上来说，某个页面得到的链接越多，在一定程度上反映了该页面内容丰富，相对应的链接权重也就越高。比如维基百科。
4. 页面加载速度：现在这年代，网页的加载速度越来越重要了，每个人愿意在我们网页上停留的时间可能1秒都不到。这时候如果我们页面要过好几秒才能加载成功，用户可能早就不耐烦的关闭网页走人了。那我们前面做了那么多高质量的内容也就失去了意义，所以日常工作中需要做好移动端以及 PC 端的结构优化，去掉冗余的代码，提升网页加载速度。
5. 竞价排名：通过竞标方式确定，并与特定的关键词挂钩。金主爸爸针对某一关键词给出的竞标金额越高，当访问者以该关键词搜索时，该用户网站排名越靠前。竞价排名的始祖就是 overture，凭借着竞争排名，登陆纳斯达克，后续被雅虎收购。国内最先使用的就是我们所熟知的百度。  

网上的大佬们也通过经验以及测试推测出某些排名因素，感兴趣的话，可以自己去搜搜了解了解。

比如，当用户输入“如何制作xxxx”时，搜索引擎会分析这个查询背后所代表的意思，分析之后得知用户是在寻找一些教程说明时，返回的结果页就会包含一些视频或者博客网站。

如果用户输入“购买xxxx”时，搜索引擎会根据“购买”这个关键词分析得出用户现在正在寻找要购买的东西，因此返回的结果可能包括电子商务网站和在线商店。



好了，我们已经知道了搜索引擎的原理了。给大家三天时间，写一个搜索引擎出来 ( 3分 ) ！




ok，这期视频主要讲了搜索引擎的原理，发展历史，以及简单了解了未来的发展。会有讲错的地方，也欢迎大家在评论或弹幕上探讨。



## 参考文献

chatGPT

https://dmthought.com/search-engine-working-principle/

https://zhuanlan.zhihu.com/p/208846943

https://www.xnbeast.com/google-algorithm-ranking-factors/



视频素材

https://www.youtube.com/watch?v=0eKVizvYSUQ

https://www.youtube.com/watch?v=LVV_93mBfSU

https://www.youtube.com/watch?v=iMYn1GJzzCM







